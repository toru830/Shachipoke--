<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ã‚·ãƒ£ãƒãƒã‚±ï¼’ - ã‚·ãƒ³ãƒ—ãƒ«ç‰ˆ</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            padding: 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            text-align: center;
        }
        .container {
            max-width: 600px;
            margin: 0 auto;
            background: rgba(255,255,255,0.1);
            padding: 30px;
            border-radius: 20px;
            backdrop-filter: blur(10px);
        }
        button {
            background: #007bff;
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 25px;
            cursor: pointer;
            font-size: 16px;
            margin: 10px;
            transition: all 0.3s ease;
        }
        button:hover {
            background: #0056b3;
            transform: translateY(-2px);
        }
        .character-grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 15px;
            margin: 20px 0;
        }
        .character-card {
            background: rgba(255,255,255,0.2);
            padding: 20px;
            border-radius: 15px;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        .character-card:hover {
            background: rgba(255,255,255,0.3);
            transform: translateY(-5px);
        }
        .character-card.selected {
            background: rgba(0,123,255,0.5);
        }
        .character-icon {
            font-size: 3rem;
            margin-bottom: 10px;
        }
        .character-name {
            font-size: 0.9rem;
            font-weight: bold;
        }
        .hidden {
            display: none;
        }
        .status {
            margin: 20px 0;
            padding: 15px;
            background: rgba(255,255,255,0.1);
            border-radius: 10px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ‹ ã‚·ãƒ£ãƒãƒã‚±ï¼’ ğŸ‹</h1>
        
        <div id="loading-screen">
            <h2>èª­ã¿è¾¼ã¿ä¸­...</h2>
            <div id="loading-status">ã‚²ãƒ¼ãƒ ã‚’åˆæœŸåŒ–ã—ã¦ã„ã¾ã™...</div>
        </div>
        
        <div id="character-selection" class="hidden">
            <h2>ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼é¸æŠ</h2>
            <p>æœ€åˆã®ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼ã‚’é¸ã‚“ã§ãã ã•ã„</p>
            <div class="character-grid" id="character-grid">
                <!-- ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼ãŒã“ã“ã«è¡¨ç¤ºã•ã‚Œã¾ã™ -->
            </div>
            <button id="confirm-btn" disabled>é¸æŠç¢ºå®š</button>
        </div>
        
        <div id="main-game" class="hidden">
            <h2>ãƒ¡ã‚¤ãƒ³ã‚²ãƒ¼ãƒ </h2>
            <div class="status">
                <p>é¸æŠã•ã‚ŒãŸã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼: <span id="selected-character">-</span></p>
                <p>ã‚·ãƒ£ãƒ: <span id="currency">0</span></p>
            </div>
            <button onclick="showCharacterSelection()">ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼é¸æŠã«æˆ»ã‚‹</button>
        </div>
        
        <div id="debug-info">
            <h3>ãƒ‡ãƒãƒƒã‚°æƒ…å ±</h3>
            <div id="debug-log"></div>
        </div>
    </div>

    <script>
        // ãƒ‡ãƒãƒƒã‚°ç”¨ãƒ­ã‚°é–¢æ•°
        function debugLog(message) {
            console.log(message);
            const debugLog = document.getElementById('debug-log');
            debugLog.innerHTML += '<div>' + new Date().toLocaleTimeString() + ': ' + message + '</div>';
        }

        // ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼ãƒ‡ãƒ¼ã‚¿ï¼ˆç°¡ç•¥ç‰ˆï¼‰
        const characters = [
            { id: 'ikisui', name: 'ç”Ÿç²‹ã®ç¤¾ç•œ', icon: 'ğŸ‘¨â€ğŸ’¼' },
            { id: 'genkai', name: 'é™ç•Œçªç ´ç¤¾ç•œ', icon: 'ğŸ‘©â€ğŸ’¼' },
            { id: 'muhai', name: 'ç„¡æ•—ã®è·äººç¤¾ç•œ', icon: 'ğŸ‘¨â€ğŸ’»' },
            { id: 'kokou', name: 'å­¤é«˜ã®æˆæœä¸»ç¾©ç¤¾ç•œ', icon: 'ğŸ‘©â€ğŸ’»' },
            { id: 'kokoro', name: 'å¿ƒå„ªã—ãç¤¾ç•œ', icon: 'ğŸ‘¨â€ğŸ”§' },
            { id: 'seijitsu', name: 'èª å®Ÿãªè¦³å¯Ÿç¤¾å“¡', icon: 'ğŸ‘©â€ğŸ”§' },
            { id: 'kyousou', name: 'å…±å‰µãƒªãƒ¼ãƒ€ãƒ¼ç¤¾å“¡', icon: 'ğŸ‘¨â€ğŸ¨' },
            { id: 'mypace', name: 'ãƒã‚¤ãƒšãƒ¼ã‚¹ç¤¾å“¡', icon: 'ğŸ‘©â€ğŸ¨' },
            { id: 'yurufuwa', name: 'ã‚†ã‚‹ãµã‚ç¤¾ç•œ', icon: 'ğŸ‘¨â€ğŸ’¼' },
            { id: 'kakure', name: 'éš ã‚Œç–²åŠ´ç¤¾ç•œ', icon: 'ğŸ‘©â€ğŸ’¼' },
            { id: 'ohitoyoshi', name: 'ãŠäººå¥½ã—ç¤¾å“¡', icon: 'ğŸ‘¨â€ğŸ’»' },
            { id: 'genjitsu', name: 'ç¾å®Ÿæ´¾ç¤¾å“¡', icon: 'ğŸ‘©â€ğŸ’»' },
            { id: 'katei', name: 'å®¶åº­ãŒå¤§äº‹ç¤¾å“¡', icon: 'ğŸ‘¨â€ğŸ”§' },
            { id: 'balancer', name: 'ãƒãƒ©ãƒ³ã‚µãƒ¼ç¤¾å“¡', icon: 'ğŸ‘©â€ğŸ”§' },
            { id: 'seika', name: 'æˆæœæœ€é©åŒ–ç¤¾ç•œ', icon: 'ğŸ‘¨â€ğŸ¨' },
            { id: 'jiyujin', name: 'è‡ªç”±äºº', icon: 'ğŸ‘©â€ğŸ¨' }
        ];

        let selectedCharacter = null;

        // åˆæœŸåŒ–
        function init() {
            debugLog('ãƒšãƒ¼ã‚¸èª­ã¿è¾¼ã¿é–‹å§‹');
            
            try {
                // ãƒ­ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ç”»é¢ã‚’è¡¨ç¤º
                showScreen('loading');
                
                // ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼ã‚°ãƒªãƒƒãƒ‰ã‚’ä½œæˆ
                createCharacterGrid();
                
                // ã‚¤ãƒ™ãƒ³ãƒˆãƒªã‚¹ãƒŠãƒ¼ã‚’è¨­å®š
                setupEventListeners();
                
                // 2ç§’å¾Œã«ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼é¸æŠç”»é¢ã‚’è¡¨ç¤º
                setTimeout(() => {
                    debugLog('ãƒ­ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°å®Œäº†ã€ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼é¸æŠç”»é¢ã‚’è¡¨ç¤º');
                    showScreen('character-selection');
                }, 2000);
                
            } catch (error) {
                debugLog('åˆæœŸåŒ–ã‚¨ãƒ©ãƒ¼: ' + error.message);
                document.getElementById('loading-status').textContent = 'ã‚¨ãƒ©ãƒ¼: ' + error.message;
            }
        }

        // ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼ã‚°ãƒªãƒƒãƒ‰ã‚’ä½œæˆ
        function createCharacterGrid() {
            const grid = document.getElementById('character-grid');
            grid.innerHTML = '';
            
            characters.forEach(character => {
                const card = document.createElement('div');
                card.className = 'character-card';
                card.dataset.characterId = character.id;
                card.innerHTML = `
                    <div class="character-icon">${character.icon}</div>
                    <div class="character-name">${character.name}</div>
                `;
                
                card.addEventListener('click', () => selectCharacter(character.id));
                grid.appendChild(card);
            });
            
            debugLog('ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼ã‚°ãƒªãƒƒãƒ‰ä½œæˆå®Œäº†: ' + characters.length + 'ä½“');
        }

        // ã‚¤ãƒ™ãƒ³ãƒˆãƒªã‚¹ãƒŠãƒ¼ã‚’è¨­å®š
        function setupEventListeners() {
            document.getElementById('confirm-btn').addEventListener('click', confirmSelection);
            debugLog('ã‚¤ãƒ™ãƒ³ãƒˆãƒªã‚¹ãƒŠãƒ¼è¨­å®šå®Œäº†');
        }

        // ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼é¸æŠ
        function selectCharacter(characterId) {
            debugLog('ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼é¸æŠ: ' + characterId);
            
            // å‰ã®é¸æŠã‚’è§£é™¤
            document.querySelectorAll('.character-card').forEach(card => {
                card.classList.remove('selected');
            });
            
            // æ–°ã—ã„é¸æŠã‚’è¿½åŠ 
            const selectedCard = document.querySelector(`[data-character-id="${characterId}"]`);
            if (selectedCard) {
                selectedCard.classList.add('selected');
                selectedCharacter = characterId;
                document.getElementById('confirm-btn').disabled = false;
                debugLog('ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼é¸æŠå®Œäº†: ' + characterId);
            }
        }

        // é¸æŠç¢ºå®š
        function confirmSelection() {
            if (!selectedCharacter) {
                debugLog('ã‚¨ãƒ©ãƒ¼: ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼ãŒé¸æŠã•ã‚Œã¦ã„ã¾ã›ã‚“');
                return;
            }
            
            debugLog('ã‚²ãƒ¼ãƒ é–‹å§‹: ' + selectedCharacter);
            
            // é¸æŠã•ã‚ŒãŸã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼åã‚’è¡¨ç¤º
            const character = characters.find(c => c.id === selectedCharacter);
            if (character) {
                document.getElementById('selected-character').textContent = character.name;
                debugLog('ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼æƒ…å ±æ›´æ–°: ' + character.name);
            }
            
            // ãƒ¡ã‚¤ãƒ³ã‚²ãƒ¼ãƒ ç”»é¢ã‚’è¡¨ç¤º
            debugLog('ãƒ¡ã‚¤ãƒ³ã‚²ãƒ¼ãƒ ç”»é¢ã«åˆ‡ã‚Šæ›¿ãˆä¸­...');
            showScreen('main-game');
        }

        // ç”»é¢è¡¨ç¤ºåˆ‡ã‚Šæ›¿ãˆ
        function showScreen(screenName) {
            debugLog('ç”»é¢åˆ‡ã‚Šæ›¿ãˆ: ' + screenName);
            
            // ã™ã¹ã¦ã®ç”»é¢ã‚’éè¡¨ç¤º
            const allScreens = [
                'loading-screen',
                'character-selection', 
                'main-game'
            ];
            
            allScreens.forEach(screenId => {
                const screen = document.getElementById(screenId);
                if (screen) {
                    screen.classList.add('hidden');
                }
            });
            
            // æŒ‡å®šã•ã‚ŒãŸç”»é¢ã‚’è¡¨ç¤º
            const targetScreen = document.getElementById(screenName);
            if (targetScreen) {
                targetScreen.classList.remove('hidden');
                debugLog('ç”»é¢è¡¨ç¤ºå®Œäº†: ' + screenName);
            } else {
                debugLog('ã‚¨ãƒ©ãƒ¼: ç”»é¢ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“: ' + screenName);
                // ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯: ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼é¸æŠç”»é¢ã‚’è¡¨ç¤º
                const fallbackScreen = document.getElementById('character-selection');
                if (fallbackScreen) {
                    fallbackScreen.classList.remove('hidden');
                    debugLog('ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯: ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼é¸æŠç”»é¢ã‚’è¡¨ç¤º');
                }
            }
        }

        // ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼é¸æŠã«æˆ»ã‚‹
        function showCharacterSelection() {
            showScreen('character-selection');
        }

        // ãƒšãƒ¼ã‚¸èª­ã¿è¾¼ã¿æ™‚ã«åˆæœŸåŒ–
        document.addEventListener('DOMContentLoaded', init);
        
        // ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°
        window.addEventListener('error', function(e) {
            debugLog('JavaScriptã‚¨ãƒ©ãƒ¼: ' + e.error.message);
        });
    </script>
</body>
</html>
